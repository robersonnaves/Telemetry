# Telegraf configuration bridging Prometheus remote_write to QuestDB via ILP
[agent]
  interval = "10s"
  flush_interval = "10s"
  metric_batch_size = 5000
  metric_buffer_limit = 50000
  omit_hostname = true

# Input: Prometheus remote_write (native endpoint /api/v1/write)
[[inputs.prometheus_remote_write]]
  listen = ":9201"
  # Optional: set path if not default
  # path = "/api/v1/write"
  # queue settings for backpressure
  # max_body_size = 50000000

# Optional processors (examples commented out)
# [[processors.regex]]
#   namepass = ["http_requests_total"]
#   [[processors.regex.tags]]
#     key = "path"
#     pattern = "^/internal/.*"
#     replacement = "/internal"

# [[aggregators.basicstats]]
#   period = "1m"
#   drop_original = true
#   stats = ["mean","max","min"]
#   namepass = ["process_cpu_seconds_total","go_memstats_alloc_bytes"]

# Output: QuestDB via Influx Line Protocol over TCP
[[outputs.socket_writer]]
  address = "tcp://questdb:9009"
  data_format = "influx"
  keep_alive_period = "30s"
  # inactivity_timeout and tls options not supported in current Telegraf version
